<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Dave Kurman &middot; 
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="/public/css/rouge.css">
  <link rel="stylesheet" href="/public/css/styles.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12118444-14"></script>
  <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-12118444-14');
  </script>

</head>


  <body>

    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>
        <a href="/">
          
        </a>
      </h1>
      <p class="lead">Dave Kurman / Computer Systems Analyst / Expertise in computer programming, database, web development, system administration
</p>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item" href="/">Home</a>

      

      
      
        
      
        
          
            <a class="sidebar-nav-item" href="/about/">About</a>
          
        
      
        
          
            <a class="sidebar-nav-item" href="/contact/">Contact</a>
          
        
      
        
          
            <a class="sidebar-nav-item" href="/deerhub/">Deerhub</a>
          
        
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/omega-design-corporation/">Omega Design Corporation</a>
          
        
      
        
          
            <a class="sidebar-nav-item" href="/quebecor-world-printing/">Quebecor World Printing</a>
          
        
      
        
          
            <a class="sidebar-nav-item" href="/vanguard-id-systems/">Vanguard ID Systems</a>
          
        
      
        
          
            <a class="sidebar-nav-item" href="/wallace-deer-management-association-website/">WDMA</a>
          
        
      
        
      
        
          
        
      
        
          
        
      

    <div class="contact-info">
        <a href="https://www.linkedin.com/in/davekurman/" target="_blank" title="  Dave Kurman - LinkedIn  ">
            <img src="/public/linkedin-logo.png">
        </a>
        <a href="https://github.com/p7th0n" target="_blank" title="  Dave Kurman - Github  ">
            <img src="/public/GitHub_Logo_White.png">
        </a>
        <a href="https://twitter.com/davekurman" target="_blank" title="  Dave Kurman - Twitter  ">
            <img src="/public/twitter-logo.png">
        </a>
    </div>


      <span class="sidebar-nav-item">v 1.3</span>
    </nav>

    <p>&copy; 2022. All rights reserved.</p>
  </div>
</div>


    <div class="content container">
      <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2017/07/who-has-that-damn-excel-file-locked/">
        Check for locked files
      </a>
    </h1>

    <span class="post-date">12 Jul 2017</span>

    <p>Companies work from Excel, Word and other files on network shared folders. More than one user cannot usually work on these files at the same time. Time is lost tracking down who has the file locked.</p>

<p>It can be hard to see who has a file locked. Sometimes Excel or Word shows who. But not always. Other files like shared PDF’s and CAD file types do not help much.</p>

<p>One way to see who locked a file is from the Windows file server as Administrator. Not practical for security reasons.</p>

<p>This tool has two parts:</p>

<ul>
  <li>A watcher that checks for locked files. The watcher uses a search list for <em>watched</em> files and folders.</li>
  <li>A web server that displays the locked files and who locked them. No need for special access. Just check a web page.</li>
</ul>

<h2 id="quick-setup">Quick setup</h2>

<ul>
  <li>Clone or download and extract this <a href="https://github.com/p7th0n/check_for_locked_files">Github repo</a> to a folder on the file server.</li>
  <li>Make sure <a href="https://nodejs.org/en/">NodeJS</a> and npm are installed and on the PATH. Open a command line to the repo location and run <strong>npm install</strong> to initialize.</li>
  <li>From the same command line start the web server – <strong>npm start</strong>. By default it runs on port 80 so if that is a problem edit <em>package.json</em> <em>scripts/start</em>. Visit <a href="http://fileserver-name/">http://fileserver-name</a>.</li>
  <li>In a separate command line start File lock watcher <strong>npm run watch</strong> [requires <em><strong>Administrator</strong></em> privledges]</li>
</ul>

<p><img src="https://github.com/p7th0n/check_for_locked_files/raw/master/wwwroot/assets/img/check-lock-files-screenshot.png" alt="screenshot" /></p>

<p><a href="https://github.com/p7th0n/check_for_locked_files"><img src="https://github.com/favicon.ico" alt="octocat" /></a></p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2017/06/gettp-get-source-code-todos-for-a-taskpaper-formatted-file/">
        getTP -- Get Source Code TODO's for a TaskPaper formatted file
      </a>
    </h1>

    <span class="post-date">25 Jun 2017</span>

    <p>This is a quick and simple Python script that uses <a href="https://github.com/ggreer/the_silver_searcher">Ag – The Silver Searcher</a> to find ‘TODO’ items in a source tree.</p>

<p>The output is formatted for the <a href="https://www.taskpaper.com/">TaskPaper</a> plain text format and sent to stdout. The output can be piped to a .taskpaper file.</p>

<p>Nothing fancy. Ag is super fast and does the heavy lifting. The Python code formats the Ag format to TaskPaper.</p>

<ul>
  <li>The current directory name is used for the root project name.</li>
  <li>Each file with TODO’s are sub-projects. The sub-project names include relative directories.</li>
  <li>Tasks begin with the line number of the TODO.</li>
</ul>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
  <span class="na">gettp</span><span class="pi">:</span>

    <span class="s">getTP.py</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">line</span><span class="pi">:</span> <span class="s">2    Combine TODO's to a TaskPaper list</span>
      <span class="pi">-</span> <span class="na">line</span><span class="pi">:</span> <span class="s">8    todo_command = 'ag TODO'</span>
      <span class="pi">-</span> <span class="na">line</span><span class="pi">:</span> <span class="s">13   Use Ag Silver Searcher to find TODO comments in source</span>

    <span class="s">README.md</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">line</span><span class="pi">:</span> <span class="s">1</span>    <span class="c1"># getTP - Get Source Code TODO's for a TaskPaper formatted file</span>
      <span class="pi">-</span> <span class="na">line</span><span class="pi">:</span> <span class="s">3    This is a quick and simple Python script that uses [Ag - The Silver Searcher]...</span>

    <span class="s">sample//test.md</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">line</span><span class="pi">:</span> <span class="s">5    * TODO</span><span class="pi">:</span> <span class="s">Ad </span><span class="no">null</span><span class="s">a ad Lorem quis et quis in in laborum incididunt adipisicing occaecat id voluptate.</span>

</code></pre></div></div>

<p><a href="https://github.com/p7th0n/clipboardlink"><img src="https://github.com/favicon.ico" alt="octocat" /></a></p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2017/05/bfg-repo-cleaner/">
        BFG Repo-Cleaner
      </a>
    </h1>

    <span class="post-date">30 May 2017</span>

    <h2 id="bfg-repo-cleaner-is-a-good-tool-to-clean-up-a-git-repository-before-sharing"><a href="https://rtyley.github.io/bfg-repo-cleaner/">BFG Repo-Cleaner</a> is a good tool to clean up a Git repository before sharing</h2>

<p>Removes large or troublesome blobs like git-filter-branch does, but faster. And written in Scala.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
bfg <span class="nt">--strip-blobs-bigger-than</span> 100M <span class="nt">--replace-text</span> banned.txt repo.git

</code></pre></div></div>

<p>Replace all passwords and listed in a file <em>(prefix lines ‘regex:’; or ‘glob:’; if required)</em> with <code class="language-bash highlighter-rouge"><span class="k">***</span>REMOVED<span class="k">***</span></code> wherever they occur in your repository :</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
bfg <span class="nt">--replace-text</span> passwords.txt  my-repo.git

</code></pre></div></div>

<p>Delete all files named ‘id_rsa’ or id_dsa’ :</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
bfg <span class="nt">--delete-files</span> id_<span class="o">{</span>dsa,rsa<span class="o">}</span> my-repo.git

</code></pre></div></div>

<h2 id="using-bfg-on-windows">Using BFG on Windows</h2>

<ul>
  <li>Use <a href="https://superuser.com/questions/1053633/what-is-git-bash-for-windows-anyway">Git Bash</a> or <a href="https://msdn.microsoft.com/en-us/commandline/wsl/install_guide">Windows 10 Bash</a>.</li>
  <li>Download and install Java from <a href="https://www.java.com/en/download/manual.jsp">here</a>.</li>
  <li>Download BFG <a href="https://search.maven.org/remote_content?g=com.madgag&amp;a=bfg&amp;v=LATEST">here</a>.</li>
  <li>Make an alias for BFG:</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
java <span class="nt">-jar</span> bfg.jar <span class="nv">$*</span>

</code></pre></div></div>

<ul>
  <li>Make a replace.txt file:</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
PASSWORD        <span class="c"># Replaces PASSWORD with ***REMOVED***</span>
<span class="nv">PASSWORD</span><span class="o">==&gt;</span>TEST <span class="c"># Replaces PASSWORD with TEST</span>
<span class="nv">PASSWORD</span><span class="o">==&gt;</span>     <span class="c"># Replaces PASSWORD with blank</span>
                <span class="c"># You can use Regular Expressions also</span>

</code></pre></div></div>

<ul>
  <li>Run this command in the repo folder from Git Bash or Win10 Bash:</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
bfg <span class="nt">--replace-text</span> replace.txt

</code></pre></div></div>

<ul>
  <li>When bfg is done run these commands</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
git reflog expire <span class="nt">-expire</span><span class="o">=</span>now <span class="nt">-all</span> <span class="o">&amp;&amp;</span> git gc <span class="nt">-prune</span><span class="o">=</span>now <span class="nt">--</span> aggressive

git push                   <span class="c"># -f may be needed</span>

</code></pre></div></div>

<h2 id="notes">Notes</h2>

<ul>
  <li>I had already pushed the repo and shared it.  That got complicated by multiple branches.  My fault.  It would have been much simpler to run bfg before sharing.</li>
  <li>I fumbled a bit trying to get bfg running in Windows command shell.</li>
</ul>

<h2 id="resources">Resources</h2>

<ul>
  <li><a href="https://stackoverflow.com/questions/tagged/bfg-repo-cleaner">StackOverflow</a></li>
  <li><a href="https://stackoverflow.com/questions/tagged/bfg-repo-cleaner">Removing Keys, Passwords and Other Sensitive Data from Old Github Commits on OSX</a></li>
  <li><a href="https://rtyley.github.io/bfg-repo-cleaner/">BFG Repo-Cleaner – Removes large or troublesome blobs like git-filter-branch does, but faster. And written in Scala.</a></li>
  <li><a href="https://github.com/IBM/BluePic/wiki/Using-BFG-Repo-Cleaner-tool-to-remove-sensitive-files-from-your-git-repo">Using BFG Repo Cleaner tool to remove sensitive files from your git repo</a></li>
  <li><a href="https://github.com/IBM/BluePic/wiki/Using-BFG-Repo-Cleaner-tool-to-remove-sensitive-files-from-your-git-repo">The BFG Repo Cleaner</a></li>
</ul>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2017/05/microsoft-windows-file-server-locked-file-watcher/">
        Microsoft Windows File Server Locked File Watcher
      </a>
    </h1>

    <span class="post-date">29 May 2017</span>

    <ul>
  <li>It is common for companies to work with Excel, Word and other files on Windows network shared folders.</li>
  <li>More than one user cannot usually work on files like Excel at the same time.</li>
  <li>When trying to open a locked network file it can be hard to see who has it locked.</li>
  <li>The best method to see who has a file locked is from the Windows file server. But that requires Administrator level access. That level of access is not practical for all users for security reasons.</li>
  <li>This tool has two parts:</li>
  <li>A Powershell process that watches for locked files and saves the result.</li>
  <li>A web server that displays the locked files and who has them locked.</li>
  <li>No special access is required to view the web results.The Powershell process uses</li>
  <li>The Powershell process uses a list of <em>watched</em> files and folders. This limits the number of files displayed. This also allows it to avoid showing sensitive files or network folders.</li>
</ul>

<p>Visit <a href="https://github.com/p7th0n/check_for_locked_files">Github</a> to download.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2017/04/cliplink-a-utility-for-short-reliable-links-on-windows-networks/">
        Cliplink -- a utility for short, reliable links on Windows networks
      </a>
    </h1>

    <span class="post-date">06 Apr 2017</span>

    <h3 id="what-is-cliplink-for">What is Cliplink for</h3>

<ul>
  <li>Users wanted a way to create reliable links to files and folders on Windows network drives.</li>
  <li>Spaces and special characters break Outlook’s hyperlinks to network files. Clipboard-Link fixes that problem.</li>
</ul>

<h3 id="how-do-i-get-set-up"><a href="https://github.com/p7th0n/clipboardlink#how-do-i-get-set-up"></a>How do I get set up</h3>

<ul>
  <li>Get Cliplink from =&gt; <strong><a href="https://github.com/p7th0n/clipboardlink">GitHub</a></strong>.</li>
  <li>There is no configuration</li>
  <li>There are no dependencies</li>
  <li>No database configuration</li>
  <li>Save the contents of this repo to a network drive or share.</li>
  <li>Tell users to run <strong>setup</strong> from there.</li>
</ul>

<h3 id="how-does-it-work"><a href="https://github.com/p7th0n/clipboardlink#how-does-it-work"></a>How does it work</h3>

<ul>
  <li>Locate the file or folder on the network.</li>
  <li>Right-click and select <strong>Send To</strong> &gt; <strong>clipboard-link</strong></li>
  <li>Cliplink creates a safe link to the file and puts it on the Clipboard.</li>
  <li>Paste the link into Email, documents, etc.</li>
</ul>

<h3 id="to-make-a-friendly-link"><a href="https://github.com/p7th0n/clipboardlink#to-make-a-friendly-link"></a>To make a friendly link</h3>

<ul>
  <li>Create a link to a network file or folder with Clipboard-link and paste into a message</li>
  <li>Select the link part and Cut</li>
  <li>Select the name part between the brackets</li>
  <li>Select Insert menu &gt; Hyperlink</li>
  <li>Paste the link in the URL box</li>
  <li>Click Ok</li>
  <li>Clipboard-link copies the file/folder name and shortened link to the clipboard</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
  <span class="o">[</span>Engineering Documentation]                  file://F:<span class="se">\E</span>NGINE~1

          ^ Name ^                               ^   <span class="nb">link</span>  ^

</code></pre></div></div>

<p>NOTE: **Cliplink will not create links for executables [files ending with EXE, COM, BAT, etc.].</p>

<p><a href="https://github.com/p7th0n/clipboardlink"><img src="https://github.com/favicon.ico" alt="octocat" /></a></p>

  </div>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/page3">Older</a>
  
  
    
      <a class="pagination-item newer" href="/">Newer</a>
    
  
</div>
    </div>

  </body>
</html>
